{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useContext, useEffect, useState } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { Icon } from 'react-native-elements';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { withNavigation } from \"react-navigation\";\nimport CartCard from \"../../components/CartCard/CartCard\";\nimport { COLORS } from \"../../consts/colors\";\nimport { Context as CartContext } from \"../../context/CartContext\";\nimport styles from \"./styles\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar CartScreen = function CartScreen(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isFetching = _useState2[0],\n      setIsFetching = _useState2[1];\n\n  var _useContext = useContext(CartContext),\n      state = _useContext.state,\n      fetchCartItems = _useContext.fetchCartItems,\n      emptyCart = _useContext.emptyCart,\n      updateItemsCart = _useContext.updateItemsCart;\n\n  useEffect(function () {\n    var unsub = navigation.addListener('focus', function () {\n      fetchCartItems();\n    });\n    return unsub;\n  }, [navigation]);\n\n  var clearCart = function clearCart() {\n    emptyCart();\n  };\n\n  var EmptyListMessage = function EmptyListMessage(_ref2) {\n    var item = _ref2.item;\n    return _jsx(Text, {\n      style: styles.emptyListStyle,\n      onPress: function onPress() {\n        return getItem(item);\n      },\n      children: \"Co\\u0219\"\n    });\n  };\n\n  var onAddQuantity = function onAddQuantity(item, index, initialPrice) {\n    var cartItems = _toConsumableArray(state.books);\n\n    cartItems[index].quantity += 1;\n    cartItems[index].price = initialPrice * cartItems[index].quantity;\n    updateItemsCart(cartItems);\n  };\n\n  var onSubstractQuantity = function onSubstractQuantity(item, index, initialPrice) {\n    console.log(\"CartScreenStateOnSub1:\");\n\n    var cartItems = _toConsumableArray(state.books);\n\n    cartItems[index].quantity -= 1;\n    cartItems[index].price -= initialPrice;\n    updateItemsCart(cartItems);\n  };\n\n  return _jsxs(SafeAreaView, {\n    style: {\n      backgroundColor: COLORS.white,\n      flex: 2\n    },\n    children: [_jsxs(View, {\n      style: styles.header,\n      children: [_jsx(View, {\n        style: {\n          flex: 1,\n          alignItems: 'flex-start',\n          paddingVertical: 3\n        },\n        children: _jsx(Icon, {\n          name: \"arrow-back-ios\",\n          size: 20,\n          onPress: function onPress() {\n            return navigation.navigate('Biblioteca');\n          }\n        })\n      }), _jsx(View, {\n        style: {\n          flex: 2.6,\n          alignItems: 'baseline'\n        },\n        children: _jsx(Text, {\n          style: {\n            fontSize: 20,\n            fontFamily: 'AllerLight',\n            fontWeight: 'bold'\n          },\n          children: \"Co\\u0219 de cump\\u0103r\\u0103turi\"\n        })\n      })]\n    }), _jsx(FlatList, {\n      showsVerticalScrollIndicator: false,\n      contentContainerStyle: {\n        paddingBottom: 80\n      },\n      data: state.books,\n      ListEmptyComponent: EmptyListMessage,\n      renderItem: function renderItem(_ref3) {\n        var item = _ref3.item,\n            index = _ref3.index;\n        return _jsx(CartCard, {\n          onAdd: function onAdd(initialPrice) {\n            return onAddQuantity(item, index, initialPrice);\n          },\n          onSubstract: function onSubstract(initialPrice) {\n            return onSubstractQuantity(item, index, initialPrice);\n          },\n          index: index,\n          book: item\n        });\n      },\n      ListFooterComponentStyle: {\n        paddingHorizontal: 20,\n        marginTop: 20,\n        flex: 1\n      },\n      ListFooterComponent: function ListFooterComponent() {\n        return _jsxs(View, {\n          children: [_jsxs(View, {\n            style: {\n              flexDirection: 'row',\n              justifyContent: 'space-between',\n              marginVertical: 15\n            },\n            children: [_jsx(Text, {\n              style: {\n                fontSize: 18,\n                fontWeight: 'bold'\n              },\n              children: \"Total:\"\n            }), _jsxs(Text, {\n              style: {\n                fontSize: 18,\n                fontWeight: 'bold'\n              },\n              children: [\"\\u20AC\", state.totalPrice]\n            })]\n          }), _jsxs(View, {\n            style: {\n              flexDirection: 'row',\n              marginHorizontal: 10,\n              justifyContent: 'space-between'\n            },\n            children: [_jsx(View, {\n              style: styles.buyBtn,\n              children: _jsx(Text, {\n                style: {\n                  color: COLORS.white,\n                  fontSize: 18,\n                  fontFamily: 'AllerLight'\n                },\n                children: \"Pl\\u0103teste\"\n              })\n            }), _jsx(TouchableOpacity, {\n              onPress: function onPress() {\n                return clearCart();\n              },\n              children: _jsx(View, {\n                style: styles.buyBtn,\n                children: _jsx(Text, {\n                  style: {\n                    color: COLORS.white,\n                    fontSize: 18,\n                    fontFamily: 'AllerLight'\n                  },\n                  children: \"Goleste cosul\"\n                })\n              })\n            })]\n          })]\n        });\n      }\n    })]\n  });\n};\n\nexport default withNavigation(CartScreen);","map":{"version":3,"names":["useContext","useEffect","useState","Icon","TouchableOpacity","SafeAreaView","withNavigation","CartCard","COLORS","Context","CartContext","styles","CartScreen","navigation","isFetching","setIsFetching","state","fetchCartItems","emptyCart","updateItemsCart","unsub","addListener","clearCart","EmptyListMessage","item","emptyListStyle","getItem","onAddQuantity","index","initialPrice","cartItems","books","quantity","price","onSubstractQuantity","console","log","backgroundColor","white","flex","header","alignItems","paddingVertical","navigate","fontSize","fontFamily","fontWeight","paddingBottom","paddingHorizontal","marginTop","flexDirection","justifyContent","marginVertical","totalPrice","marginHorizontal","buyBtn","color"],"sources":["E:/PROGRAMMING/REACT_NATIVE/biblioteca/src/screens/CartScreen/CartScreen.js"],"sourcesContent":["import { useContext, useEffect, useState } from 'react';\r\nimport { FlatList, Text, View } from 'react-native';\r\nimport { Icon } from 'react-native-elements';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport { SafeAreaView } from 'react-native-safe-area-context';\r\nimport { withNavigation } from \"react-navigation\";\r\nimport CartCard from '../../components/CartCard/CartCard';\r\nimport { COLORS } from '../../consts/colors';\r\nimport { Context as CartContext } from '../../context/CartContext';\r\nimport styles from './styles';\r\n\r\nconst CartScreen = ({ navigation }) => {\r\n    const [isFetching, setIsFetching] = useState(false);\r\n\r\n    const { state, fetchCartItems, emptyCart, updateItemsCart } = useContext(CartContext);\r\n\r\n    useEffect(() => {\r\n        const unsub = navigation.addListener('focus', () => { fetchCartItems() })\r\n        return unsub\r\n\r\n    }, [navigation])\r\n\r\n    // const fetchData = () => {\r\n    //     setTimeout(function () { fetchCartItems() }, 1000)\r\n    //     fetchCartItems()\r\n    //     setIsFetching(false);\r\n    // };\r\n\r\n    // const onRefresh = () => {\r\n    //     setIsFetching(true);\r\n    //     fetchData();\r\n    // };\r\n\r\n    const clearCart = () => {\r\n        emptyCart();\r\n    }\r\n\r\n    const EmptyListMessage = ({ item }) => {\r\n        return (\r\n            <Text style={styles.emptyListStyle} onPress={() => getItem(item)}>\r\n                Coș\r\n            </Text>\r\n        );\r\n    };\r\n\r\n    const onAddQuantity = (item, index, initialPrice) => {\r\n        const cartItems = [...state.books];\r\n        cartItems[index].quantity += 1;\r\n        cartItems[index].price = initialPrice * cartItems[index].quantity;\r\n        updateItemsCart(cartItems);\r\n    }\r\n\r\n    const onSubstractQuantity = (item, index, initialPrice) => {\r\n        console.log(\"CartScreenStateOnSub1:\")\r\n        const cartItems = [...state.books];\r\n        cartItems[index].quantity -= 1;\r\n        cartItems[index].price -= initialPrice;\r\n        updateItemsCart(cartItems);\r\n    }\r\n\r\n\r\n    return (\r\n        <SafeAreaView style={{ backgroundColor: COLORS.white,flex:2 }}>\r\n            <View style={styles.header}>\r\n                <View style={{ flex: 1, alignItems: 'flex-start', paddingVertical: 3 }}>\r\n                    <Icon name=\"arrow-back-ios\" size={20} onPress={() => navigation.navigate('Biblioteca')} />\r\n                </View>\r\n                <View style={{ flex: 2.6, alignItems: 'baseline' }}>\r\n                    <Text style={{ fontSize: 20, fontFamily: 'AllerLight', fontWeight: 'bold', }}>Coș de cumpărături</Text>\r\n                </View>\r\n            </View>\r\n            <FlatList\r\n                showsVerticalScrollIndicator={false}\r\n                contentContainerStyle={{ paddingBottom: 80 }}\r\n                data={state.books}\r\n                // onRefresh={onRefresh}\r\n                // refreshing={isFetching}\r\n                ListEmptyComponent={EmptyListMessage}\r\n                renderItem={\r\n                    ({ item, index }) =>\r\n                        <CartCard\r\n                            onAdd={(initialPrice) => onAddQuantity(item, index, initialPrice)}\r\n                            onSubstract={(initialPrice) => onSubstractQuantity(item, index, initialPrice)}\r\n                            index={index}\r\n                            book={item}\r\n                        />\r\n                }\r\n                ListFooterComponentStyle={{ paddingHorizontal: 20, marginTop: 20, flex:1 }}\r\n                ListFooterComponent={\r\n                    () => (\r\n                        <View  >\r\n                            <View\r\n                                style={{\r\n                                    flexDirection: 'row',\r\n                                    justifyContent: 'space-between',\r\n                                    marginVertical: 15,\r\n                                }}>\r\n                                <Text style={{ fontSize: 18, fontWeight: 'bold' }}>\r\n                                    Total:\r\n                                </Text>\r\n                                <Text style={{ fontSize: 18, fontWeight: 'bold' }}>€{state.totalPrice}</Text>\r\n                            </View>\r\n                            <View style={{ flexDirection: 'row', marginHorizontal: 10, justifyContent: 'space-between' }}>\r\n                                <View style={styles.buyBtn}>\r\n                                    <Text style={{ color: COLORS.white, fontSize: 18, fontFamily: 'AllerLight' }}>Plăteste</Text>\r\n                                </View>\r\n                                <TouchableOpacity onPress={() => clearCart()}>\r\n                                    <View style={styles.buyBtn}>\r\n                                        <Text style={{ color: COLORS.white, fontSize: 18, fontFamily: 'AllerLight' }}>Goleste cosul</Text>\r\n                                    </View>\r\n                                </TouchableOpacity>\r\n                            </View>\r\n\r\n                        </View>\r\n                    )\r\n                }\r\n            />\r\n        </SafeAreaView>\r\n    );\r\n};\r\n\r\nexport default withNavigation(CartScreen);"],"mappings":"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"},"metadata":{},"sourceType":"module"}